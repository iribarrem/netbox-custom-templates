bgp {{ device.cf['ASN'].asn }}
    {% for bgp_session in netbox_bgp.BGPSession.objects.all() %}
    peer {{ bgp_session.remote_address.ip }} as-number {{ bgp_session.remote_as }}
    peer {{ bgp_session.remote_address.ip }} enable
    peer {{ bgp_session.remote_address.ip }} advertise-community
    peer {{ bgp_session.remote_address.ip }} advertise-ext-community
    {% if bgp_session.cf['keep_all_routes'] %}
    peer {{ bgp_session.remote_address }} keep-all-routes
    {% endif %}
    {% endfor %}
    ipv4-family-unicast
        #
    #
{% for bgp_session in netbox_bgp.BGPSession.objects.all() %}
    {% if bgp_session.device == device %}
        {% for policy in bgp_session.import_policies.all() +%}
            {% include "huawei/bgp/route-policies.html" %}
        {% endfor %}
        {% for policy in bgp_session.export_policies.all() +%}
            {% include "huawei/bgp/route-policies.html" %}
        {% endfor %}
    {% endif %}
{% endfor %}